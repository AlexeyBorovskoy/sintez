# План тестирования подключения к контроллеру

## Общая информация

**Контроллер:** 192.168.75.150  
**Дата начала тестирования:** _______________  
**Тестировщик:** _______________

---

## Этап 0: Подготовка

### Шаг 0.1: Проверка доступности контроллера
- [ ] **Действие:** Выполнить ping к контроллеру
- [ ] **Команда:** `ping -c 4 192.168.75.150`
- [ ] **Ожидаемый результат:** 0% потерь пакетов, время отклика < 10 мс
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 0.2: Проверка открытых портов
- [ ] **Действие:** Проверить доступность портов SSH, HTTPS, SNMP
- [ ] **Команда:** `nc -zv 192.168.75.150 22 443 && nc -zv -u 192.168.75.150 161`
- [ ] **Ожидаемый результат:** Все порты открыты и доступны
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 0.3: Сборка тестовой утилиты
- [ ] **Действие:** Собрать проект и тестовую утилиту
- [ ] **Команда:** 
  ```bash
  cd /home/alexey/shared_vm/spectr_utmc/spectr_utmc/spectr_utmc_cpp
  mkdir -p build && cd build && cmake .. && make
  ```
- [ ] **Ожидаемый результат:** Успешная сборка, создан файл `test_controller`
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

---

## Этап 1: Базовое SNMP подключение

### Шаг 1.1: Определение правильного community string
- [ ] **Действие:** Попробовать подключиться с разными community strings
- [ ] **Команда:** 
  ```bash
  ./build/test_controller connect 192.168.75.150 UTMC
  ./build/test_controller connect 192.168.75.150 public
  ./build/test_controller connect 192.168.75.150 private
  ```
- [ ] **Ожидаемый результат:** Один из community strings успешно подключается
- [ ] **Фактический результат:** ________________
- [ ] **Рабочий community:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 1.2: Создание SNMP сессии
- [ ] **Действие:** Проверить создание SNMP сессии
- [ ] **Команда:** `./build/test_controller connect 192.168.75.150 <COMMUNITY>`
- [ ] **Ожидаемый результат:** Сообщение "OK: Session created successfully"
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

---

## Этап 2: SNMP GET операции

### Шаг 2.1: Получение sysUpTime (стандартный SNMP)
- [ ] **Действие:** Выполнить GET запрос для sysUpTime
- [ ] **OID:** `1.3.6.1.2.1.1.3.0`
- [ ] **Ожидаемый результат:** Получено значение времени работы системы (в сотых долях секунды)
- [ ] **Фактический результат:** ________________
- [ ] **Значение:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 2.2: Получение версии приложения
- [ ] **Действие:** Выполнить GET запрос для версии ПО контроллера
- [ ] **OID:** `1.3.6.1.4.1.13267.3.2.1.2`
- [ ] **Ожидаемый результат:** Получена строка с версией приложения (например, "V001")
- [ ] **Фактический результат:** ________________
- [ ] **Значение:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 2.3: Получение режима работы контроллера
- [ ] **Действие:** Выполнить GET запрос для режима работы
- [ ] **OID:** `1.3.6.1.4.1.13267.3.2.4.1`
- [ ] **Ожидаемый результат:** Получено значение режима (1=Standalone, 2=Monitor, 3=UTC Control)
- [ ] **Фактический результат:** ________________
- [ ] **Значение:** ________________
- [ ] **Режим:** ⬜ Standalone / ⬜ Monitor / ⬜ UTC Control / ⬜ Неизвестно
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 2.4: Получение времени контроллера
- [ ] **Действие:** Выполнить GET запрос для системного времени контроллера
- [ ] **OID:** `1.3.6.1.4.1.13267.3.2.3.2.0`
- [ ] **Ожидаемый результат:** Получена строка времени в формате YYYYMMDDHHmmssZ
- [ ] **Фактический результат:** ________________
- [ ] **Значение:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 2.5: Получение текущей фазы
- [ ] **Действие:** Выполнить GET запрос для текущей фазы
- [ ] **OID:** `1.3.6.1.4.1.13267.3.2.5.1.1.3` (utcReplyGn)
- [ ] **Ожидаемый результат:** Получено значение текущей фазы (число от 1 до 7)
- [ ] **Фактический результат:** ________________
- [ ] **Значение:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

---

## Этап 3: SNMP SET операции (осторожно!)

### Шаг 3.1: Проверка возможности SET операций
- [ ] **Действие:** Проверить, разрешены ли SET операции (только проверка, без выполнения)
- [ ] **Метод:** Попытка чтения прав доступа через веб-интерфейс или документацию
- [ ] **Ожидаемый результат:** Подтверждение, что SET операции разрешены
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Разрешено / ⬜ Запрещено / ⬜ Неизвестно
- [ ] **Примечания:** ________________

### Шаг 3.2: Тестовый SET - запрос режима работы (только если разрешено)
- [ ] **Действие:** Попытка установить режим работы (только если это безопасно)
- [ ] **OID:** `1.3.6.1.4.1.13267.3.2.4.1`
- [ ] **Значение:** 2 (Monitor) - безопасный режим
- [ ] **Ожидаемый результат:** Успешное изменение режима или ошибка доступа
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка / ⬜ Пропущено
- [ ] **Примечания:** ________________

---

## Этап 4: SNMP Traps/Informs

### Шаг 4.1: Запуск приемника traps
- [ ] **Действие:** Запустить приемник SNMP traps на порту 10162
- [ ] **Команда:** `./build/test_controller traps 10162 <COMMUNITY>`
- [ ] **Ожидаемый результат:** Приемник запущен и ожидает traps
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 4.2: Проверка приема traps (если контроллер настроен)
- [ ] **Действие:** Ожидание входящих traps от контроллера
- [ ] **Время ожидания:** 30 секунд
- [ ] **Ожидаемый результат:** Получен хотя бы один trap/inform от контроллера
- [ ] **Фактический результат:** ________________
- [ ] **Количество traps:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка / ⬜ Traps не получены
- [ ] **Примечания:** ________________

### Шаг 4.3: Анализ структуры полученных traps
- [ ] **Действие:** Проанализировать структуру полученных traps
- [ ] **Проверка:** 
  - [ ] Наличие OID источника
  - [ ] Наличие varbinds с данными
  - [ ] Формат данных соответствует ожидаемому
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка / ⬜ Пропущено
- [ ] **Примечания:** ________________

---

## Этап 5: Тестирование протокола Spectr-ITS

### Шаг 5.1: Подготовка тестового TCP подключения
- [ ] **Действие:** Проверить возможность подключения к ITS серверу (если доступен)
- [ ] **Метод:** Проверка доступности хоста из config.json
- [ ] **Ожидаемый результат:** Определение доступности ITS сервера
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка / ⬜ Пропущено
- [ ] **Примечания:** ________________

### Шаг 5.2: Тестирование формата команд Spectr-ITS
- [ ] **Действие:** Проверить корректность форматирования команд протокола
- [ ] **Метод:** Использование функций из spectr_protocol.cpp
- [ ] **Проверка:**
  - [ ] Формат команды SET_PHASE
  - [ ] Формат команды GET_STAT
  - [ ] Проверка checksum
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

---

## Этап 6: Интеграционное тестирование

### Шаг 6.1: Запуск основного приложения
- [ ] **Действие:** Запустить основное приложение с тестовым config.json
- [ ] **Команда:** `./build/spectr_utmc_cpp config.json`
- [ ] **Ожидаемый результат:** Приложение запущено без ошибок
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 6.2: Проверка обработки SNMP notifications
- [ ] **Действие:** Проверить обработку входящих SNMP notifications
- [ ] **Метод:** Мониторинг логов приложения при получении traps
- [ ] **Ожидаемый результат:** Notifications корректно обрабатываются и преобразуются в события
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка
- [ ] **Примечания:** ________________

### Шаг 6.3: Проверка отправки команд на контроллер
- [ ] **Действие:** Проверить отправку команд SET_PHASE (если разрешено)
- [ ] **Метод:** Симуляция команды от ITS сервера или прямой вызов
- [ ] **Ожидаемый результат:** Команда успешно отправлена и выполнена контроллером
- [ ] **Фактический результат:** ________________
- [ ] **Статус:** ⬜ Успешно / ⬜ Ошибка / ⬜ Пропущено
- [ ] **Примечания:** ________________

---

## Этап 7: Анализ результатов и выводы

### Шаг 7.1: Сводка результатов тестирования
- [ ] **Действие:** Составить сводную таблицу результатов
- [ ] **Проверка:** 
  - [ ] Количество успешных тестов
  - [ ] Количество неудачных тестов
  - [ ] Количество пропущенных тестов
- [ ] **Результат:** ________________
- [ ] **Статус:** ⬜ Завершено
- [ ] **Примечания:** ________________

### Шаг 7.2: Выявление проблем и их анализ
- [ ] **Действие:** Проанализировать все обнаруженные проблемы
- [ ] **Список проблем:**
  1. ________________
  2. ________________
  3. ________________
- [ ] **Приоритет:** ⬜ Критично / ⬜ Важно / ⬜ Низкий
- [ ] **Статус:** ⬜ Завершено
- [ ] **Примечания:** ________________

### Шаг 7.3: Рекомендации по исправлению
- [ ] **Действие:** Составить список рекомендаций
- [ ] **Рекомендации:**
  1. ________________
  2. ________________
  3. ________________
- [ ] **Статус:** ⬜ Завершено
- [ ] **Примечания:** ________________

---

## Шаблон для записи результатов теста

```
### Тест: [Название теста]
**Дата/Время:** _______________
**Исполнитель:** _______________

**Команда/Действие:**
```
[Команда или описание действия]
```

**Ожидаемый результат:**
[Что должно произойти]

**Фактический результат:**
[Что произошло на самом деле]

**Выводы:**
[Анализ результатов]

**Требуются изменения:**
- [ ] Да / Нет
- [ ] Описание необходимых изменений: ________________

**Статус:** ⬜ Успешно / ⬜ Ошибка / ⬜ Пропущено
```

---

## Примечания

1. **Безопасность:** При выполнении SET операций убедитесь, что это не повлияет на работу контроллера в продакшене
2. **Логирование:** Сохраняйте все выводы команд и логи для последующего анализа
3. **Документирование:** Заполняйте все поля в плане тестирования для полноты картины
4. **Итеративность:** После каждого теста анализируйте результаты и при необходимости вносите изменения в код

---

## Следующие шаги после завершения тестирования

1. Исправление выявленных проблем
2. Повторное тестирование исправленных компонентов
3. Документирование результатов
4. Подготовка отчета о тестировании
