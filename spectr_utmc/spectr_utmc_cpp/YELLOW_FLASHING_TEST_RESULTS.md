# Результаты тестирования включения желтого мигания

**Дата:** 2026-02-03  
**Контроллер:** 192.168.75.150  
**Метод:** С учетом требований документации (удержание FF=1 минимум 10 секунд)

---

## Выполненные операции

### 1. Проверка исходного состояния
- **Operation Mode:** `1` (Standalone)
- **Current Phase:** `Hex-STRING: 10` (фаза 5)
- **GetAF (ЖМ):** `0` (выключено)

### 2. Установка режима UTC Control и FF=1 (множественный SET)
```bash
./build/test_controller setmulti 192.168.75.150 UTMC \
  1.3.6.1.4.1.13267.3.2.4.1 2 3 \
  1.3.6.1.4.1.13267.3.2.4.2.1.20 2 1
```

**Результат:** ✅ Успешно
- Operation Mode: `3` (UTC Control)
- FF: `1`

### 3. Удержание FF=1 в течение 12 секунд
Периодически переустанавливали FF=1 каждые 2 секунды в течение 12 секунд (6 раз).

**Результат:** ✅ FF=1 удерживался минимум 10 секунд

### 4. Ожидание завершения минимальных периодов работы фаз
Ждали 15 секунд для завершения минимальных периодов работы фаз.

**Результат:** Фаза изменилась на `Hex-STRING: 80`

### 5. Повторная установка FF=1 и ожидание
Установили FF=1 снова и ждали еще 10 секунд.

**Результат:** ❌ GetAF все еще показывает `0` (ЖМ не включено)

---

## Текущее состояние

- **Operation Mode:** `3` (UTC Control) ✅
- **FF (SET):** `1` ✅
- **GetAF (ЖМ):** `0` ❌ (не включено)
- **Current Phase:** `Hex-STRING: 80` (изменилась)

---

## Анализ проблемы

### ✅ Что выполнено правильно:

1. **Установлен режим UTC Control (3)** - выполнено
2. **Установлен FF=1** - выполнено
3. **FF=1 удерживался минимум 10 секунд** - выполнено (12 секунд)
4. **Ожидание завершения минимальных периодов** - выполнено (15+ секунд)

### ❌ Возможные причины проблемы:

1. **Отсутствие передачи SCN:**
   - Согласно документации, SetAF требует передачи SCN
   - Мы не передаем SCN в наших SET запросах
   - Возможно, контроллер игнорирует команды без SCN

2. **Контроллер не поддерживает включение ЖМ через SNMP:**
   - Возможно, контроллер настроен так, что ЖМ можно включить только через веб-интерфейс
   - Или требуется специальная конфигурация контроллера

3. **Требуются дополнительные условия:**
   - Может быть, нужна определенная фаза перед включением ЖМ
   - Или нужны другие параметры, которые мы не устанавливаем

4. **Проблема с форматом команды:**
   - Возможно, SCN должен передаваться как часть OID или в другом формате
   - Или нужна другая последовательность команд

---

## Выводы

### Что работает:
- ✅ SET операции выполняются успешно
- ✅ Контроллер принимает команды
- ✅ Режим UTC Control устанавливается корректно
- ✅ FF=1 устанавливается корректно

### Что не работает:
- ❌ ЖМ не включается визуально
- ❌ GetAF не показывает включение ЖМ (всегда 0)

### Возможные решения:

1. **Проверить передачу SCN:**
   - Выяснить, как именно передается SCN для SetAF
   - Попробовать передать SCN в запросе

2. **Проверить через веб-интерфейс:**
   - Включить ЖМ через веб-интерфейс
   - Посмотреть, какие параметры изменяются
   - Сравнить с нашими SNMP командами

3. **Проверить документацию контроллера:**
   - Может быть, есть дополнительные требования
   - Или специальная последовательность команд

4. **Проверить конфигурацию контроллера:**
   - Возможно, нужно включить поддержку ЖМ через SNMP в настройках
   - Или проверить другие параметры конфигурации

---

## Рекомендации

1. **Попробовать включить ЖМ через веб-интерфейс** и посмотреть, что происходит
2. **Изучить логи контроллера** при попытке включения ЖМ через SNMP
3. **Проверить документацию контроллера** на предмет дополнительных требований
4. **Связаться с производителем** для уточнения требований к включению ЖМ через SNMP

---

## Статус

⚠️ **Проблема не решена**

- Все условия из документации выполнены
- FF=1 удерживался минимум 10 секунд
- Но ЖМ не включается

**Требуется дальнейшее исследование или проверка через веб-интерфейс.**
