# Инструкция по тестированию жёлтого мигания

## Подготовка

1. **Проверка доступности контроллера:**
   ```bash
   cd /home/alexey/shared_vm/spectr_utmc/spectr_utmc/AI_reaserh
   node utmc-tester.js --ip 192.168.75.150 --community UTMC --test
   ```

2. **Проверка текущего состояния:**
   ```bash
   node utmc-tester.js --ip 192.168.75.150 --community UTMC --status
   ```

## Вариант 1: Простой тест (shell скрипт)

**Запуск:**
```bash
cd /home/alexey/shared_vm/spectr_utmc/spectr_utmc/spectr_utmc_cpp
./test_yf_simple.sh
```

**Что делает:**
- Отправляет команду включения мигания
- Удерживает команду в течение 60 секунд (отправка каждые 2 секунды)
- Автоматически отключает мигание после 60 секунд
- Проверяет состояние контроллера

**Визуальный контроль:**
- Наблюдайте за контроллером в течение всего теста
- Проверьте, активировалось ли жёлтое мигание
- Проверьте, отключилось ли мигание автоматически

## Вариант 2: Тест через C++ приложение

**Запуск:**
```bash
cd /home/alexey/shared_vm/spectr_utmc/spectr_utmc/spectr_utmc_cpp
./build/spectr_utmc_cpp config.json
```

**В другом терминале отправка команды:**
```bash
# Эмуляция команды от АСУДД (через netcat или другой TCP клиент)
echo "#15:30:45 SET_YF 12345$XX" | nc commserver.cudd 3000
```

**Логи:**
- Смотрите вывод приложения для логов удержания команды
- Формат: `[YF_HOLD] ...`

## Вариант 3: Прямой SNMP тест

**Активация:**
```bash
snmpset -v2c -c UTMC 192.168.75.150 \
  1.3.6.1.4.1.13267.3.2.4.1 i 3 \
  1.3.6.1.4.1.13267.3.2.4.2.1.20 i 1
```

**Удержание (в цикле):**
```bash
for i in {1..30}; do
  echo "[$((i*2)) сек] Отправка команды..."
  snmpset -v2c -c UTMC 192.168.75.150 \
    1.3.6.1.4.1.13267.3.2.4.1 i 3 \
    1.3.6.1.4.1.13267.3.2.4.2.1.20 i 1
  sleep 2
done
```

**Отключение:**
```bash
snmpset -v2c -c UTMC 192.168.75.150 \
  1.3.6.1.4.1.13267.3.2.4.1 i 3 \
  1.3.6.1.4.1.13267.3.2.4.2.1.20 i 0
```

## Проверка состояния

**Режим мигания:**
```bash
snmpget -v2c -c UTMC 192.168.75.150 1.3.6.1.4.1.13267.3.2.5.1.1.36
```

**Текущая фаза:**
```bash
snmpget -v2c -c UTMC 192.168.75.150 1.3.6.1.4.1.13267.3.2.5.1.1.3
```

## Что проверять

1. ✅ **Активация мигания:** визуально видно жёлтое мигание на контроллере
2. ✅ **Длительность:** мигание работает в течение 60 секунд
3. ✅ **Отключение:** мигание автоматически отключается после 60 секунд
4. ✅ **Восстановление режима:** контроллер возвращается в обычный режим работы
5. ✅ **Логи:** все операции логируются корректно

## Безопасность

- Все операции безопасны для контроллера
- При необходимости можно вернуть в локальный режим:
  ```bash
  snmpset -v2c -c UTMC 192.168.75.150 1.3.6.1.4.1.13267.3.2.4.1 i 0
  ```
