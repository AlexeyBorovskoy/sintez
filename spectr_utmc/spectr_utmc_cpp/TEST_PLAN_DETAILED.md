# Детальный план тестирования с использованием веб-интерфейса

**Дата:** 2026-02-03  
**Контроллер:** 192.168.75.150  
**Веб-интерфейс:** https://192.168.75.150/  
**Учетные данные:** admin / zBCTRuV7

**Формат тестирования:** Сделали → Получили → Результат → Сравнили с ожиданием → Если не устраивает → Вносим изменения и повторяем

---

## Этап 0: Подготовка и проверка базовых GET операций ✅ ЗАВЕРШЕН

### Шаг 0.1: Проверка доступности контроллера
- **Действие:** Ping контроллера
- **Команда:** `ping -c 2 192.168.75.150`
- **Ожидаемый результат:** 0% потерь
- **Фактический результат:** ✅ Успешно
- **Статус:** ✅ Завершен

### Шаг 0.2: Проверка базовых GET операций
- **Результаты:**
  - ✅ sysUpTime - работает
  - ✅ Application Version - работает (1.4.20)
  - ✅ Operation Mode - работает (1 = Standalone)
  - ✅ Controller Time - работает
- **Статус:** ✅ Завершен

### Шаг 0.3: Проверка дополнительных GET операций
- **Результаты:**
  - ✅ GetPhase - работает
  - ✅ GetError - работает (0 = нет ошибок)
  - ✅ GetWarnings - работает (0 = нет предупреждений)
  - ✅ GetRCP - работает (0 = панель не активна)
  - ✅ GetAF - работает (0 = ЖМ выключено)
- **Статус:** ✅ Завершен

---

## Этап 1: Подключение к веб-интерфейсу и проверка текущего состояния

### Шаг 1.1: Открытие веб-интерфейса
- **Действие:** Открыть веб-интерфейс контроллера
- **Инструкция для пользователя:**
  1. Откройте браузер
  2. Введите в адресной строке: `https://192.168.75.150/`
  3. Нажмите Enter
  4. Ожидается редирект на `/login`
- **Ожидаемый результат:** Открыта страница входа в систему
- **Проверка:** Страница загрузилась без ошибок
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

### Шаг 1.2: Вход в систему
- **Действие:** Войти в веб-интерфейс
- **Инструкция для пользователя:**
  1. В поле "Логин" введите: `admin`
  2. В поле "Пароль" введите: `zBCTRuV7`
  3. Нажмите кнопку "Войти" (или Enter)
- **Ожидаемый результат:** Успешный вход, отображена главная страница
- **Проверка:** Видна главная страница с информацией о светофоре
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

### Шаг 1.3: Проверка текущего режима через веб-интерфейс
- **Действие:** Проверить текущий режим работы на главной странице
- **Инструкция для пользователя:**
  1. На главной странице найдите поле "Основная информация о светофоре"
  2. Найдите строку "Текущий режим работы"
  3. Зафиксируйте значение режима
- **Ожидаемый результат:** Отображается текущий режим (Локальный/Адаптивный/Удаленный)
- **Проверка:** Значение режима соответствует SNMP GET запросу
- **Сравнение с SNMP:**
  - Выполнить: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.4.1`
  - Сравнить значение режима в веб-интерфейсе с SNMP значением
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

### Шаг 1.4: Проверка текущей фазы через веб-интерфейс
- **Действие:** Проверить текущую фазу на главной странице
- **Инструкция для пользователя:**
  1. На главной странице найдите строку "Текущая фаза"
  2. Зафиксируйте номер фазы и общее количество фаз
- **Ожидаемый результат:** Отображается текущая фаза (например, "Фаза 1 из 4")
- **Проверка:** Значение фазы соответствует SNMP GET запросу
- **Сравнение с SNMP:**
  - Выполнить: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.5.1.1.3`
  - Сравнить значение фазы в веб-интерфейсе с SNMP значением
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

---

## Этап 2: Изменение режима работы через веб-интерфейс

### Шаг 2.1: Изменение режима на "Локальный" (если не установлен)
- **Действие:** Установить режим "Локальный" через веб-интерфейс
- **Инструкция для пользователя:**
  1. На главной странице найдите кнопку "Локальный"
  2. Нажмите кнопку "Локальный"
  3. Подтвердите изменение (если требуется)
  4. Дождитесь применения изменений (обычно несколько секунд)
- **Ожидаемый результат:** Режим изменен на "Локальный"
- **Проверка через SNMP:**
  - Выполнить: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.4.1`
  - Ожидаемое значение: `INTEGER: 1` (Standalone = Локальный)
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________
- **Если не устраивает:** Проверить права доступа, повторить попытку

### Шаг 2.2: Проверка других параметров в режиме "Локальный"
- **Действие:** Проверить, как изменились другие параметры
- **Проверка через SNMP:**
  1. GetPhase: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.5.1.1.3`
  2. GetError: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.5.1.1.5`
  3. GetWarnings: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.5.1.1.16`
  4. GetRCP: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.5.1.1.15`
  5. GetAF: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.5.1.1.36`
- **Ожидаемый результат:** Все параметры доступны для чтения
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

### Шаг 2.3: Изменение режима на "Адаптивный" (Monitor)
- **Действие:** Установить режим "Адаптивный" через веб-интерфейс
- **Инструкция для пользователя:**
  1. На главной странице найдите кнопку "Адаптивный"
  2. Нажмите кнопку "Адаптивный"
  3. Подтвердите изменение (если требуется)
  4. Дождитесь применения изменений
- **Ожидаемый результат:** Режим изменен на "Адаптивный"
- **Проверка через SNMP:**
  - Выполнить: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.4.1`
  - Ожидаемое значение: `INTEGER: 2` (Monitor = Адаптивный)
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________
- **Если не устраивает:** Проверить права доступа, повторить попытку

### Шаг 2.4: Проверка других параметров в режиме "Адаптивный"
- **Действие:** Проверить параметры в новом режиме
- **Проверка через SNMP:** (те же команды, что в шаге 2.2)
- **Ожидаемый результат:** Все параметры доступны, возможно изменение некоторых значений
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

### Шаг 2.5: Тестирование приема traps в режиме "Адаптивный"
- **Действие:** Запустить приемник traps и проверить получение traps
- **Команда:** `./build/test_controller traps 10162 UTMC`
- **Время ожидания:** 30-60 секунд
- **Ожидаемый результат:** Возможно получение traps (в режиме Monitor контроллер может отправлять traps)
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

### Шаг 2.6: Настройка протокола UG405 для режима "Удаленный" (UTC Control)
- **Действие:** Настроить протокол UG405 для перехода в режим "Удаленный"
- **Инструкция для пользователя:**
  1. Перейдите во вкладку "Управление контроллером" (в верхнем меню)
  2. Найдите раздел выбора протокола централизованного управления
  3. Выберите протокол "UG405"
  4. В поле "SCN" введите значение (формат: COX, где X - число от 1 до 9999, например: CO1111)
  5. Нажмите кнопку "Сохранить"
  6. Дождитесь применения изменений
- **Ожидаемый результат:** Протокол UG405 настроен, SCN задан
- **Проверка:** Протокол отображается как выбранный, SCN сохранен
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________
- **Если не устраивает:** Проверить формат SCN, повторить попытку

### Шаг 2.7: Изменение режима на "Удаленный" (UTC Control)
- **Действие:** Установить режим "Удаленный" через веб-интерфейс
- **Инструкция для пользователя:**
  1. Вернитесь на главную страницу
  2. Найдите кнопку управления режимом (возможно, это отдельная кнопка или выбор в меню)
  3. Выберите режим "Удаленный" или "UTC Control"
  4. Подтвердите изменение
  5. Дождитесь применения изменений
- **Ожидаемый результат:** Режим изменен на "Удаленный"
- **Проверка через SNMP:**
  - Выполнить: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.4.1`
  - Ожидаемое значение: `INTEGER: 3` (UTC Control = Удаленный)
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________
- **Если не устраивает:** Проверить настройку протокола UG405, повторить попытку

### Шаг 2.8: Проверка других параметров в режиме "Удаленный"
- **Действие:** Проверить параметры в режиме UTC Control
- **Проверка через SNMP:** (те же команды, что в шаге 2.2)
- **Ожидаемый результат:** Все параметры доступны, возможно активная работа traps
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

### Шаг 2.9: Тестирование приема traps в режиме "Удаленный"
- **Действие:** Запустить приемник traps в режиме UTC Control
- **Команда:** `./build/test_controller traps 10162 UTMC`
- **Время ожидания:** 30-60 секунд
- **Ожидаемый результат:** Возможно получение traps (в режиме UTC Control контроллер активно отправляет traps)
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

---

## Этап 3: Тестирование SET операций с откатом через веб-интерфейс

**⚠️ ВАЖНО:** Все SET операции выполняются с возможностью отката через веб-интерфейс

### Шаг 3.1: Подготовка к тестированию SET операций
- **Действие:** Зафиксировать текущее состояние контроллера
- **Проверка через SNMP:**
  1. Operation Mode: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.4.1`
  2. GetPhase: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.5.1.1.3`
  3. GetAF: `./build/test_controller get 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.5.1.1.36`
- **Зафиксировать значения:**
  - Текущий режим: ________________
  - Текущая фаза: ________________
  - Состояние ЖМ: ________________
- **Статус:** ⬜ Выполнено

### Шаг 3.2: Создание тестовой утилиты для SET операций
- **Действие:** Добавить команду `set` в `test_controller`
- **Требования:**
  - Команда: `./build/test_controller set <ip> <community> <oid> <type> <value>`
  - Поддержка типов: INTEGER, OCTET_STR
  - Вывод результата SET операции
- **Статус:** ⬜ Выполнено / ⬜ Требуется реализация

### Шаг 3.3: Тестирование SET Operation Mode (с откатом через веб)
- **Условие:** Контроллер должен быть в режиме, который позволяет изменение
- **Действие:** Попытка установить режим через SET
- **Команда:** (будет создана после шага 3.2)
- **Пример:** `./build/test_controller set 192.168.75.150 UTMC 1.3.6.1.4.1.13267.3.2.4.1 INTEGER 2`
- **Проверка через SNMP:**
  - Выполнить GET запрос для проверки изменения
- **Проверка через веб:**
  - Обновить главную страницу
  - Проверить отображение режима
- **Откат через веб:**
  - Если нужно, пользователь меняет режим обратно через кнопки на главной странице
- **Ожидаемый результат:** Режим изменен через SET, отображается в веб и SNMP
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________
- **Если не устраивает:** Проверить права доступа, режим контроллера, повторить

### Шаг 3.4: Тестирование SET Phase (с откатом через веб)
- **Условие:** Контроллер должен быть в режиме UTC Control (3)
- **Действие:** Попытка установить фазу через SET
- **Команда:** (будет создана после шага 3.2)
- **Проверка через SNMP:**
  - Выполнить GET запрос для проверки изменения фазы
- **Проверка через веб:**
  - Обновить главную страницу
  - Проверить отображение текущей фазы
- **Откат через веб:**
  - Если нужно, пользователь может изменить режим или дождаться автоматического переключения
- **Ожидаемый результат:** Фаза изменена через SET, отображается в веб и SNMP
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________
- **Если не устраивает:** Проверить режим контроллера, повторить

### Шаг 3.5: Тестирование SET AF (ЖМ) (с откатом через веб)
- **Действие:** Попытка включить желтое мигание через SET
- **Команда:** (будет создана после шага 3.2)
- **Проверка через SNMP:**
  - Выполнить GET запрос для проверки состояния ЖМ
- **Проверка через веб:**
  - Обновить главную страницу
  - Проверить состояние светофора (должно быть желтое мигание)
- **Откат через веб:**
  - Если нужно, пользователь может изменить режим или дождаться автоматического отключения
- **Ожидаемый результат:** ЖМ включено через SET, отображается в веб и SNMP
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________
- **Если не устраивает:** Проверить режим контроллера, повторить

---

## Этап 4: Интеграционное тестирование

### Шаг 4.1: Запуск основного приложения
- **Действие:** Запустить `spectr_utmc_cpp` с конфигурацией
- **Команда:** `./build/spectr_utmc_cpp config.json`
- **Ожидаемый результат:** Приложение запущено, подключено к контроллеру
- **Проверка:** Логи показывают успешное подключение
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

### Шаг 4.2: Тестирование при разных режимах контроллера
- **Действие:** Изменять режим контроллера через веб и проверять работу приложения
- **Режимы для тестирования:**
  1. Standalone (1) - Локальный
  2. Monitor (2) - Адаптивный
  3. UTC Control (3) - Удаленный
- **Проверка:** Приложение должно корректно работать во всех режимах
- **Фактический результат:** ________________
- **Статус:** ⬜ Выполнено / ⬜ Ошибка
- **Вывод:** ________________

---

## Формат выполнения каждого шага

Для каждого шага:

1. **Сделали:** Выполнили действие (команда или действие в веб-интерфейсе)
2. **Получили:** Зафиксировали результат (вывод команды или состояние веб-интерфейса)
3. **Результат:** Записали фактический результат
4. **Сравнили:** Сравнили с ожидаемым результатом
5. **Если не устраивает:** 
   - Проанализировали причину расхождения
   - Внесли изменения (в коде, настройках, или повторили действие)
   - Повторили шаг

---

## Текущий статус

✅ **Этап 0:** Завершен (базовые GET операции работают)  
⬜ **Этап 1:** Готов к выполнению (подключение к веб-интерфейсу)  
⬜ **Этап 2:** Готов к выполнению (изменение режимов через веб)  
⬜ **Этап 3:** Готов к выполнению (SET операции с откатом)  
⬜ **Этап 4:** Готов к выполнению (интеграционное тестирование)

---

## Следующий шаг

**Начать с Этапа 1, Шаг 1.1:** Открытие веб-интерфейса контроллера
