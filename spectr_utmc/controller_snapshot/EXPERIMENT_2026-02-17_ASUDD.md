# Эксперимент АСУДД -> DK 10101 (192.168.75.150), 17.02.2026

Цель: поймать, почему ЖМ (желтое мигание) иногда включается не с первой команды, и зафиксировать реальные команды/ответы.

Ограничения: никаких команд, меняющих конфигурацию контроллера; только чтение/запись логов.

## Артефакты

Снятые логи одной сессии захвата (read-only) лежат здесь:

- `spectr_utmc/controller_snapshot/experiments/2026-02-17_120120/baseline.txt`
- `spectr_utmc/controller_snapshot/experiments/2026-02-17_120120/spectr_utmc_follow.log`
- `spectr_utmc/controller_snapshot/experiments/2026-02-17_120120/resident_follow.log`
- `spectr_utmc/controller_snapshot/experiments/2026-02-17_120120/snmp_poll.log`

Старт захвата (по `baseline.txt`): `2026-02-17T12:21:00+03:00`.

## Команды, которые реально ушли на контроллер (по `spectr_utmc_follow.log`)

Наблюдались команды:

1. `SET_YF` (ЖМ): 3 раза
   - `12:21:10` (`(1608)`) -> `>O.K.`
   - `12:22:32` (`(1618)`) -> `>O.K.`
   - `12:23:18` (`(1632)`) -> `>O.K.`
2. `SET_OS` (полное отключение СО): `12:23:01` (`(1627)`) -> `>O.K.`
3. `SET_START` (перезапуск программы/контроллера): `12:23:45` (`(1637)`) -> `>O.K.`

## Факт включения ЖМ (по `resident_follow.log`)

Ключевые строки:

- `12:22:32` `Remote mode is launched ... UTMC`
- `12:22:38` `Flashing yellow.`
- `12:23:18` `Flashing yellow.`
- `12:23:45` `Beginning the program restart...`
- `12:23:51` `End of program restart...`
- `12:23:55` `Program №1 ... is running.`

То есть ЖМ **точно включался** минимум два раза: в `12:22:38` и в `12:23:18`.

## SNMP-наблюдения (по `snmp_poll.log`, community `UTMC`)

Использовались read-only OID:

- `sysUpTime.0` = `1.3.6.1.2.1.1.3.0`
- `utcType2OperationMode` = `1.3.6.1.4.1.13267.3.2.4.1`
- `utcReplyFR` = `1.3.6.1.4.1.13267.3.2.5.1.1.36`
- `utcReplyGn` = `1.3.6.1.4.1.13267.3.2.5.1.1.3`

Наблюдения:

- После `SET_YF` **OperationMode** переходит в `3` примерно в течение 1 секунды.
- Было видно автоматическое возвращение `mode=3 -> mode=1` без отдельной команды (похоже на таймаут/возврат в основную программу).
- `utcReplyFR` в этом эксперименте **иногда** становился `1` (например `12:22:39`), то есть это поле нельзя считать “всегда 0”.

## Гипотеза по “иногда срабатывает только с 3-го раза”

По `spectr_utmc_follow.log` все 3 `SET_YF` получили `>O.K.` (команда дошла и была принята).
Но `resident_follow.log` фиксирует `Remote mode launched` и `Flashing yellow` не на каждую попытку одинаково.

Самое практичное на следующий прогон: считать “успех” не по `>O.K.`, а по появлению `Flashing yellow.` в `resident/full.log`
и/или по изменению `OperationMode` + сопутствующим `EVENT/STAT` в `spectr_utmc`.

